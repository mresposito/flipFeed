@( user:User, feed: Feed )

@import helper.twitterBootstrap._

@main("FlipFeed: " + feed.name, user ) {
  <div id="feedContainer">
    <div class="page-header">
      <h1>@feed.name<small> @feed.description</small></h1>
    </div>

    @if( user.name != feed.owner ) {
      <h3 id="author"> Created by @feed.owner </h3>
    } else {
    <div class="tabs-flipfeed">
      <ul id="myTab" class="nav nav-tabs">
        <li class="active"><a href="#home" data-toggle="tab"><i class="icon-home"></i>Home</a></li>
          <li><a href="#comments" data-toggle="tab"> <i class="icon-comment"> </i>Comments</a></li>
          <li><a href="#edit" data-toggle="tab"><i class="icon-cog"></i> Edit</a></li>
      </ul>
    </div>
    }

    <div id="myTabContent" class="tab-content">
      <div class="tab-pane fade in active" id="home">
        The feedback page is currently empty. Go to <a href="#edit" data-toggle="tab">Edit</a> to personalize it.
      </div>

      <div class="tab-pane fade" id="comments">
        <!--display the comments -->
        @feeds.listComments( Comment.findByFeed ( feed.id.get ))

        @if( user.name != feed.owner ) {

        <div id="commentForm">
            <form class="span4" action="@routes.Feeds.commentOn(feed.owner, feed.name)" method="POST">
              <input type="text" rows="3" name="comment" id="comment" required></textarea>
              <input type="checkbox" name="anon" id="anon" value="anon"> Make post anonymous
              <button class="btn" type="submit" id="commentbutton">Comment</button>
          </form>
        </div>
       }

      </div>
      <div class="tab-pane fade" id="edit">
        @feeds.edit( feed )
      </div> <!--end edit-->
    </div>

   <script>
     <!-- activate the tabs -->
      $('#myTab a').click(function (e) {
        e.preventDefault();
        $(this).tab('show');
      })
      $('#myTab a[href="#edit"]').tab('show'); // Select tab by name
      $('#myTab a:first').tab('show'); // Select first tab
      $('#myTab a:last').tab('show'); // Select last tab
      $('#myTab li:eq(2) a').tab('show'); // Select third tab (0-indexed)
   </script>
 </div> <!-- end feed container-->
}
